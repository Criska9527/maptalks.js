<!--
 * @Author: wenrongz 2920356983@qq.com
 * @Date: 2023-08-14 09:38:23
 * @LastEditors: wenrongz 2920356983@qq.com
 * @LastEditTime: 2023-09-12 14:55:26
 * @FilePath: \fusion.gl\example\fusion.gl.three.html
 * @Description: 这是默认设置,请设置`customMade`, 打开koroFileHeader查看配置 进行设置: https://github.com/OBKoro1/koro1FileHeader/wiki/%E9%85%8D%E7%BD%AE
-->
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title></title>
    <script src="../dist/fusion.gl-dev.js"></script>
    <script type="text/javascript" src="https://unpkg.com/three@0.142.0/three.min.js"></script>
    <script type="text/javascript" src="https://unpkg.com/three@0.142.0/examples/js/loaders/GLTFLoader.js"></script>

</head>

<body>
    <canvas width="800" height="600" id="mapCanvas"></canvas>
    <script type="text/javascript">
        const canvas = document.getElementById('mapCanvas');
        const realGL = canvas.getContext('webgl2');
        const gl = new fusion.GLContext(realGL);
        var loader = new THREE.GLTFLoader();
        const camera = new THREE.PerspectiveCamera(70, 800 / 600, 0.01, 10000);
        camera.position.z = 1;
        scene = new THREE.Scene();
        var light = new THREE.DirectionalLight(0xffffff);
        light.position.set(0, -10, 10).normalize();
        scene.add(light);
        geometry = new THREE.BoxGeometry(0.5, 0.3, 0.8);
        material = new THREE.MeshStandardMaterial({
            color: 0xFFB6C1,
            // roughness: 0.1,
            // metalness: 0.1,
            side: THREE.FrontSide,
            // envMap: reflectionCube
        });
        mesh = new THREE.Mesh(geometry, material);
        scene.add(mesh);
        let model;
        loader.load(
            "./model/szlk_rj.glb",
            function (gltf) {
                model = gltf.scene;
                model.rotation.x = Math.PI / 2;
                model.position.set(0, 0, 0);
                //  model.scale.set(100, 100, 100);
                scene.add(model);
                model.rotation.x += 0.1;
                // scene1.add(model);
            },
            undefined,
            function (e) {
                console.error(e);
            }
        );
        renderer = new THREE.WebGLRenderer({
            canvas: canvas,
            context: gl
        });

        window.gl = gl;

        renderer.autoClear = false;
        renderer.setSize(800, 600);
        renderer.render(scene, camera);

        const gl1 = new fusion.GLContext(realGL);
        const camera1 = new THREE.PerspectiveCamera(70, 800 / 600, 0.01, 10000);
        camera1.position.z = 1;
        var scene1 = new THREE.Scene();
        var light1 = new THREE.DirectionalLight(0xffffff);
        light1.position.set(0, -10, 10).normalize();
        scene1.add(light);
        var geometry1 = new THREE.BoxGeometry(0.5, 0.3, 0.8);
        var material1 = new THREE.MeshStandardMaterial({
            color: 0xFFB6C1,
            // roughness: 0.1,
            // metalness: 0.1,
            side: THREE.FrontSide,
            // envMap: reflectionCube
        });

        var mesh1 = new THREE.Mesh(geometry1, material1);
        mesh1.rotation.x += 0.1;
        mesh1.rotation.y += 0.2;
        let model1;
        loader.load(
            "./model/szlk_rj.glb",
            function (gltf) {
                model1 = gltf.scene;
                model1.rotation.x = Math.PI / 2;
                model1.position.set(0, 0, 0);
                model1.rotation.x += 0.1;
                //  model.scale.set(100, 100, 100);
                scene1.add(model1);
            },
            undefined,
            function (e) {
                console.error(e);
            }
        );
        scene1.add(mesh1);
        window.scene = scene;
        window.scene1 = scene1;
        var renderer1 = new THREE.WebGLRenderer({
            canvas: canvas,
            context: gl1
        });
        renderer1.autoClear = false;
        renderer1.setSize(800, 600);
        renderer1.render(scene1, camera1);

        function animate() {
            requestAnimationFrame(animate);
            renderer.clear(true, true, true);
            renderer1.clear(true, true, true);
            mesh.rotation.x -= 0.01;
            mesh.rotation.y -= 0.02;
            mesh1.rotation.x += 0.01;
            mesh1.rotation.y += 0.02;
            renderer.render(scene, camera);
            renderer1.render(scene1, camera1);
        }

        animate();

    </script>
</body>

</html>
